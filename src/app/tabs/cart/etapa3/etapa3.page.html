<ion-header>
  <ion-toolbar class="etapa3-header">
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back-outline" class="etapa3-back-icon"></ion-icon>
      </ion-button>
    </ion-buttons>
    <div class="etapa3-logo">
      <div class="etapa3-logo-circle">NT</div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content class="etapa3-content">
  <!-- 4 Passos com o 3 ativo -->
  <div class="etapa3-steps">
    <div class="etapa3-step">1</div>
    <div class="etapa3-step">2</div>
    <div class="etapa3-step active">3</div>
    <div class="etapa3-step">4</div>
  </div>

  <!-- Linha verde de borda a borda -->
  <div class="etapa3-divider"></div>

  <!-- Se não está no formulário do cartão, mostra opções de pagamento -->
  <div *ngIf="!showCardForm">
    <h2 class="etapa3-title">Método de Pagamento</h2>

    <div class="etapa3-payment-options">
      <div class="etapa3-payment-option" [class.selected]="selectedPayment === 'cartao'" (click)="selectPayment('cartao')">
        <span class="etapa3-payment-text">Cartão de Crédito</span>
        <ion-icon name="card-outline" class="etapa3-payment-icon"></ion-icon>
      </div>

      <div class="etapa3-payment-option" [class.selected]="selectedPayment === 'universo'" (click)="selectPayment('universo')">
        <span class="etapa3-payment-text">Cartão Universo</span>
      </div>

      <div class="etapa3-payment-option" [class.selected]="selectedPayment === 'referencia'" (click)="selectPayment('referencia')">
        <span class="etapa3-payment-text">Referência Multibanco</span>
      </div>

      <div class="etapa3-payment-option" [class.selected]="selectedPayment === 'mbway'" (click)="selectPayment('mbway')">
        <span class="etapa3-payment-text">MB Way</span>
      </div>
    </div>
  </div>

  <!-- Se está no formulário do cartão, mostra formulário igual à imagem -->
  <div *ngIf="showCardForm">
    <h2 class="etapa3-title">Cartão de Crédito</h2>

    <div class="etapa3-card-form">
      <div class="etapa3-input-group">
        <ion-input 
          placeholder="Nome do Titular" 
          [(ngModel)]="cartao.nomeTitular"
          class="etapa3-input"
          fill="outline">
        </ion-input>
        <ion-icon name="card-outline" class="etapa3-input-icon"></ion-icon>
      </div>

      <div class="etapa3-input-group">
        <ion-input 
          placeholder="Número do Cartão" 
          [(ngModel)]="cartao.numeroCartao"
          class="etapa3-input"
          fill="outline"
          maxlength="19">
        </ion-input>
      </div>

      <div class="etapa3-input-row">
        <div class="etapa3-input-group etapa3-input-half">
          <ion-input 
            placeholder="Validade" 
            [(ngModel)]="cartao.validade"
            class="etapa3-input"
            fill="outline"
            maxlength="5">
          </ion-input>
        </div>

        <div class="etapa3-input-group etapa3-input-half">
          <ion-input 
            placeholder="CVV" 
            [(ngModel)]="cartao.cvv"
            class="etapa3-input"
            fill="outline"
            maxlength="3"
            type="password">
          </ion-input>
        </div>
      </div>
    </div>
  </div>
</ion-content>

<!-- Barra fixa no fundo com preço real do telemóvel -->
<div class="etapa3-footer-bar">
  <div class="etapa3-footer-total">
    €{{ total | number:'1.2-2' }}
  </div>
  <ion-button expand="block" class="etapa3-footer-btn" (click)="continuar()">
    Continuar
  </ion-button>
</div>
